{% extends "base.html" %}
{% block content %}
<div class="bg-slate-900 rounded-xl p-4 border border-slate-800">
  <div class="text-2xl font-bold">{{ title }}</div>
  {% if note %}
    <div class="mt-2 text-xs text-slate-300">{{ note }}</div>
  {% endif %}

  <div class="mt-4 grid grid-cols-1 lg:grid-cols-2 gap-4">
    <div class="bg-slate-950 rounded-lg border border-slate-800 p-3">
      <div class="flex items-center justify-between">
        <div class="font-semibold">Markdown copy pane</div>
        <button id="copyBtn" class="px-3 py-1 rounded bg-slate-800 hover:bg-slate-700 text-sm">Copy</button>
      </div>
      <pre id="rawMd" class="mt-3 overflow-auto text-xs whitespace-pre-wrap"><code>{{ raw_md }}</code></pre>
    </div>

    <div class="bg-slate-950 rounded-lg border border-slate-800 p-3">
      <div class="font-semibold">Rendered preview</div>
      <div class="prose prose-invert max-w-none mt-3">{{ rendered_html | safe }}</div>

      <div class="mt-4 text-xs text-slate-300">
        <div><b>Decision:</b> {{ decision['decision_id'] }}</div>
        <div><b>Status:</b> {{ decision['status'] }}</div>
        <div><b>Entity:</b> {{ decision['entity_type'] }} {{ decision['entity_id'] }}</div>
        <div><b>Action:</b> {{ decision['action'] }}</div>
      </div>
    </div>
  </div>
</div>

<script>
  document.getElementById('copyBtn').addEventListener('click', async () => {
    const text = document.getElementById('rawMd').innerText;
    await navigator.clipboard.writeText(text);
    document.getElementById('copyBtn').innerText = 'Copied';
    setTimeout(() => document.getElementById('copyBtn').innerText = 'Copy', 1200);
  });
</script>
{% endblock %}
